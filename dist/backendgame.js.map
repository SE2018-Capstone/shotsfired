{"version":3,"sources":["webpack:///webpack/bootstrap 63eb68dc18c16ed3b82a","webpack:///./src/server/game.ts","webpack:///./src/server/game-server.ts","webpack:///./src/core/game.ts","webpack:///./src/core/player.ts","webpack:///./src/core/entity.ts","webpack:///./src/core/event.ts","webpack:///./src/core/vector.ts","webpack:///./src/core/bullet.ts","webpack:///external \"process\""],"names":[],"mappings":"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","file":"backendgame.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 63eb68dc18c16ed3b82a\n **/","import { GameServer } from './game-server';\n\nnew GameServer();\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/game.ts\n **/","import { GameState, Game, InputFrame } from '../core/game';\nimport * as SocketIO from 'socket.io';\nimport * as process from 'process';\n\nconst TICKS_PER_SECOND = 60;\nexport class GameServer {\n  sockets: SocketIO.Socket[];\n  constructor() {\n    process.on('message', (m: any, socket: SocketIO.Socket) => {\n      this.sockets.push(socket);\n      if (m === 'startgame') {\n        new GameInstance(this.sockets);\n        this.sockets = [];\n      }\n    });\n  }\n}\n\nclass GameInstance {\n  game: GameState;\n  sockets: SocketIO.Socket[];\n  frameBuffer: InputFrame[];\n  disconnects: string[];\n  lastTick: number;\n  gameStartPromise: Promise<{}>;\n  startGame: () => void; // resolves the promise\n\n  constructor(sockets: SocketIO.Socket[]) {\n    this.game = Game.init();\n    this.frameBuffer = [];\n    this.disconnects = [];\n    this.lastTick = Date.now();\n    this.sockets = sockets;\n    for (var socket of this.sockets) {\n      let player = Game.addPlayer(this.game);\n      socket.on('new frames', this.acceptFrames.bind(this));\n      socket.on('disconnect', () => this.onDisconnection(player.id));\n      socket.emit('start game', {\n        playerId: player.id,\n        gameState: this.game,\n      });\n    }\n    this.tick();\n  }\n\n  tick() {\n    let {game, frameBuffer, disconnects, lastTick} = this;\n    this.frameBuffer = [];\n    this.disconnects = [];\n    let delta = Date.now() - lastTick;\n    this.lastTick += delta;\n\n    // Handle client disconnect\n    disconnects.forEach(id => Game.removePlayer(game, id));\n    let events = Game.applyInputs(game, frameBuffer);\n    events = events.concat(Game.update(game, delta));\n    Game.resolveEvents(game, events);\n    this.sendState();\n    setTimeout(this.tick.bind(this), (1/TICKS_PER_SECOND) * 1000);\n  }\n\n  onDisconnection(playerId: string) {\n    this.disconnects.push(playerId);\n  }\n\n  acceptFrames(frames: InputFrame[]) {\n    this.frameBuffer = this.frameBuffer.concat(frames);\n  }\n\n  sendState() {\n    for (var socket of this.sockets) {\n      socket.emit('state update', this.game);\n    }\n  }\n\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/game-server.ts\n **/","import { Player, PlayerState } from './player';\nimport { Bullet, BulletState } from './bullet';\nimport { EntityState, Entity } from './entity';\nimport { Event } from './event';\n\nexport interface InputFrame {\n  left: boolean;\n  right: boolean;\n  up: boolean;\n  down: boolean;\n  angle: number;\n  fired: boolean;\n  duration: number;\n  playerId: string;\n};\n\n\nexport interface GameState {\n  world: {\n    width: number;\n    height: number;\n  };\n  entities: {\n    players: {[id:string]:PlayerState};\n    bullets: {[id:string]:BulletState};\n  };\n  settings: {\n    minPlayers: number;\n    maxPlayers: number;\n  };\n};\n\nexport class Game {\n  static settings = { minPlayers: 2, maxPlayers: 4 };\n  static init(overrides: any = {}) {\n    return Object.assign({\n      settings: { minPlayers: Game.settings.minPlayers,\n                  maxPlayers: Game.settings.maxPlayers },\n      world: { width: 640, height: 480 },\n      entities: { players: {}, bullets: {} }\n    }, overrides) as GameState;\n  }\n\n  // Current issue is that the state that the parts base their\n  // information of is changing as they're all running, so behavior\n  // might change based on the order of iteration, which is bad.\n  // Immutability is the only way to fix this\n  static update(game: GameState, delta: number) {\n\n    let {players, bullets} = game.entities;\n\n    let events: Event[] = [];\n\n    Object.keys(game.entities).forEach(entityType => {\n      let entities = (game.entities as any)[entityType] as {[s: string]: EntityState};\n      Object.keys(entities).forEach(id => {\n        if (!entities[id].alive) { delete entities[id]; }\n      });\n    });\n\n    // Consider putting all entities together\n    events = Object.keys(players).reduce((events, playerId) => {\n      return events.concat(Player.update(players[playerId], delta, game));\n    }, events);\n\n    events = Object.keys(bullets).reduce((events, bulletId) => {\n      return events.concat(Bullet.update(bullets[bulletId], delta, game));\n    }, events);\n\n    return events;\n  }\n\n  static applyInputs(state: GameState, inputs: InputFrame[]) {\n    const players = state.entities.players;\n\n    var events: Event[] = [];\n    inputs.forEach(input => {\n      if (!players[input.playerId]) { return; }\n      events = events.concat(Player.applyInput(players[input.playerId], input, state));\n    });\n\n    return events;\n  }\n\n  static resolveEvents(game: GameState, events: Event[]) {\n    let { players, bullets }  = game.entities;\n\n    events.forEach(event => {\n      let sender = players[event.initiator] || bullets[event.initiator] || null;\n      let receiver = players[event.receptor] || bullets[event.receptor] || null;\n      switch(event.type) {\n        case 'COLLISION':\n          switch(sender.type) {\n            case 'player': Player.collideWith(sender, receiver, game); break;\n            case 'bullet': Bullet.collideWith(sender, receiver, game); break;\n          }\n          break;\n        case 'SPAWN_BULLET':\n          switch(sender.type) {\n            case 'player':\n              let bullet = Bullet.spawnFrom(sender);\n              bullets[bullet.id] = bullet;\n              break;\n          }\n          break;\n      }\n    });\n  }\n\n  static addPlayer(state: GameState) {\n    let player = Player.init();\n    player.pos.x = state.world.width / 2;\n    player.pos.y = state.world.height / 2;\n    state.entities.players[player.id] = player;\n    return player;\n  }\n\n  static removePlayer(state: GameState, playerId: string) {\n    delete state.entities.players[playerId];\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/game.ts\n **/","import { Entity, EntityState } from './entity';\nimport { InputFrame, GameState } from './game';\nimport { EventFactory } from './event'\n\nexport interface PlayerState extends EntityState {\n  health: number;\n  type: 'player';\n  gunCooldown: number;\n  lastFire: number;\n}\n\nconst INPUT_VEL = 200;\nexport class Player extends Entity {\n  static init(overrides: any = {}) {\n    return Object.assign(super.init(), {\n      health: 10,\n      gunCooldown: 200,\n      lastFire: 0,\n      type: 'player',\n    }, overrides) as PlayerState;\n  }\n\n  static update(player: PlayerState, delta: number, game: GameState) {\n    return super.update(player, delta, game);\n  }\n\n  public static applyInput(player: PlayerState, input: InputFrame, game: GameState) {\n    if (input.playerId !== player.id) { return; }\n\n    // Controls\n    const step = (input.duration / 1000) * INPUT_VEL;\n    const inputVel = {x: 0, y: 0};\n\n    if (input.up) { inputVel.y -= step; }\n    if (input.down) { inputVel.y += step; }\n    if (input.left) { inputVel.x -= step; }\n    if (input.right) { inputVel.x += step; }\n\n    player.orientation = input.angle;\n    player.pos.x += inputVel.x;\n    player.pos.y += inputVel.y;\n\n    let events: any = [];\n     // TODO: Investigate whether this Date.now business messes up with server\n    if (input.fired && player.lastFire + player.gunCooldown < Date.now()) {\n      player.lastFire = Date.now();\n      events.push(EventFactory.createEvent('SPAWN_BULLET', player.id, null));\n    }\n    return events;\n  }\n\n  static takeDamage(player: PlayerState, dmg: number) {\n    player.health = player.health - dmg;\n    if (player.health < 0) { player.alive = false; }\n  }\n\n  static collideWith(player: PlayerState, other: EntityState, game: GameState) {\n    return;\n  }\n\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/player.ts\n **/","import { Game, GameState, InputFrame } from './game';\nimport { Event, EventFactory } from './event';\nimport { Vec, Vector } from './vector';\n\nexport interface EntityState {\n  pos: Vector;\n  vel: Vector;\n  accel: Vector;\n  // inputVel: Vector; // The velocity due to user input\n  orientation: number; // angle in radians\n  radius: number; // Collision hitbox\n  id: string;\n  alive: boolean;\n  type: string;\n};\n\nlet lastId = 0;\n\nexport class Entity {\n  static init(overrides: any = {}) {\n    return Object.assign({\n      pos: {x: 640, y: 320},\n      vel: {x: 0, y: 0},\n      accel: {x: 0, y: 0},\n      orientation: 0,\n      radius: 10,\n      alive: true,\n      id: (\"\" + lastId++),\n    }, overrides);\n  }\n\n  static getEntities(game: GameState) {\n    return Object.keys(game.entities).reduce((fullList: Entity[], entityType: string) => {\n      let entities = (game.entities as any)[entityType];\n      return fullList.concat(Object.keys(entities).map(e => entities[e])) as Entity[];\n    }, []);\n  }\n\n  // TODO: Make this able to keep players running if they were running\n  // We need player input to be able to be inputted normally, but extrapolated when only simulated?\n  static update(entity: EntityState, delta: number, game: GameState) {\n    entity.vel = Vec.add(entity.vel, entity.accel);\n\n    entity.pos = Vec.add(entity.pos, Vec.mul(entity.vel, delta / 1000));\n\n    let events: Event[] = [];\n    Entity.getEntities(game).forEach((other: EntityState) => {\n      if (other.id !== entity.id && Entity.colliding(entity, other)) {\n        events.push(EventFactory.createEvent('COLLISION', entity.id, other.id));\n      }\n    });\n    return events;\n  }\n\n  static colliding(a: EntityState, b: EntityState) {\n    return Vec.mag(Vec.subtract(a.pos, b.pos)) < a.radius + b.radius;\n  }\n\n  static interact(entity: EntityState, other: EntityState, state: GameState) {\n    return;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/entity.ts\n **/","\nexport interface Event {\n  type: string;\n  initiator: string;\n  receptor: string;\n}\n\nexport class EventFactory {\n  static createEvent(type: string, initiator: string, receptor: string) {\n    return Object.assign({\n      type,\n      initiator,\n      receptor\n    }) as Event;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/event.ts\n **/","export interface Vector {\n  x: number;\n  y: number;\n}\n\n// TODO: Move this out probably\nexport class Vec {\n  static add (a: Vector, b: Vector) {\n    return {x: a.x + b.x, y: a.y + b.y} as Vector;\n  }\n\n  static create(x: number, y: number) {\n    return {x, y};\n  }\n\n  static subtract(a: Vector, b: Vector){\n    return Vec.add(a, {x: -b.x, y: -b.y});\n  }\n\n  static mul(v: Vector, scale: number) {\n    return {x: v.x * scale, y: v.y * scale};\n  }\n\n  static mag(v: Vector) {\n    return Math.sqrt(v.x * v.x + v.y * v.y);\n  }\n\n  static direction(angle: number) {\n    return {x: Math.cos(angle), y: Math.sin(angle)};\n  }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/vector.ts\n **/","import { EntityState, Entity } from './entity'\nimport { Game, GameState, InputFrame }  from './game'\nimport { EventFactory, Event } from './event'\nimport { Player, PlayerState } from './player';\nimport { Vec } from './vector';\n\nexport interface BulletState extends EntityState {\n  damage: number;\n  source: string;\n  type: 'bullet';\n};\n\nconst BULLET_SPEED = 300;\nexport class Bullet extends Entity {\n\n  static init(overrides: any = {}) {\n    return Object.assign(super.init(), {\n      damage: 15,\n      source: null,\n      alive: true,\n      type: 'bullet',\n    }, overrides) as BulletState;\n  }\n\n  static update(bullet: BulletState, delta: number, game: GameState){\n    if (bullet.pos.x < 0 - bullet.radius\n       || bullet.pos.x > game.world.width + bullet.radius\n       || bullet.pos.y < 0 - bullet.radius\n       || bullet.pos.y > game.world.height + bullet.radius) {\n         bullet.alive = false;\n    }\n    return super.update(bullet, delta, game);\n  }\n\n  static collideWith(bullet: BulletState, other: EntityState, state: GameState) {\n    switch(other.type) {\n      case 'player':\n        other = other as PlayerState;\n        if (other.id !== bullet.source) {\n          Player.takeDamage(other as PlayerState, bullet.damage);\n          bullet.alive = false;\n        }\n        break;\n    }\n  }\n\n  static spawnFrom(entity: EntityState) {\n    let base = Bullet.init();\n    base.source = entity.id;\n    base.pos = {x: entity.pos.x, y: entity.pos.y};\n    base.vel = Vec.mul(Vec.direction(entity.orientation), BULLET_SPEED);\n    return base;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/bullet.ts\n **/","module.exports = require(\"process\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"process\"\n ** module id = 8\n ** module chunks = 0\n **/"],"sourceRoot":""}